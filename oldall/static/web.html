<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chuck Norris Jokes</title>
    <link rel="stylesheet" href="/static/web.css">
</head>
<body>
    <div class="container">
        <h1>üòÇ Chuck Norris Jokes</h1>

        <div class="section">
            <button id="randomJokeBtn">Obtenir une blague al√©atoire</button>
            <div id="randomJoke" class="joke"></div>
        </div>

        <div class="section">
            <h2>Choisir une cat√©gorie :</h2>
            <div id="categories" class="categories"></div>
            <button id="categoryJokeBtn">Obtenir la blague de la cat√©gorie s√©lectionn√©e</button>
            <div id="categoryJoke" class="joke"></div>
        </div>
    </div>

    <script>
        async function fetchCategories() {
            const res = await fetch('/categories');
            const data = await res.json();
            const container = document.getElementById('categories');
            data.forEach(cat => {
                const label = document.createElement('label');
                label.innerHTML = `<input type="radio" name="category" value="${cat}"> ${cat}`;
                container.appendChild(label);
            });
        }

        async function fetchRandomJoke() {
            const res = await fetch('/joke/random');
            const data = await res.json();
            document.getElementById('randomJoke').innerText = data.value;
        }

        async function fetchCategoryJoke() {
            const selected = document.querySelector('input[name="category"]:checked');
            if (!selected) return alert('Veuillez choisir une cat√©gorie !');
            const res = await fetch(`/joke/${selected.value}`);
            const data = await res.json();
            document.getElementById('categoryJoke').innerText = data.value;
        }

        document.getElementById('randomJokeBtn').addEventListener('click', fetchRandomJoke);
        document.getElementById('categoryJokeBtn').addEventListener('click', fetchCategoryJoke);

        fetchCategories();
    </script>
</body>
</html>
